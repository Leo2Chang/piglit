# Verify that all possible floating point vector types may be used as
# geometry shader inputs.

[require]
GL >= 2.0
GLSL >= 1.10
GL_ARB_geometry_shader4

[vertex shader]
#version 110

attribute vec4 vertex;
attribute float f_in;
varying float f;
varying vec2 v2;
varying vec3 v3;
varying vec4 v4;

void main()
{
  gl_Position = vertex;
  f = f_in;
  v2 = f_in + vec2(1.0, 2.0);
  v3 = f_in + vec3(3.0, 4.0, 5.0);
  v4 = f_in + vec4(6.0, 7.0, 8.0, 9.0);
}

[geometry shader]
#version 110
#extension GL_ARB_geometry_shader4: enable

varying in float f[];
varying in vec2 v2[];
varying in vec3 v3[];
varying in vec4 v4[];

void main()
{
  bool ok = true;

  for (int i = 0; i < 3; i++) {
    if (v2[i] != f[i] + vec2(1.0, 2.0)) ok = false;
    if (v3[i] != f[i] + vec3(3.0, 4.0, 5.0)) ok = false;
    if (v4[i] != f[i] + vec4(6.0, 7.0, 8.0, 9.0)) ok = false;
  }

  for (int i = 0; i < 3; i++) {
    gl_Position = gl_PositionIn[i];
    gl_FrontColor = ok ? vec4(0.0, 1.0, 0.0, 1.0) : vec4(1.0, 0.0, 0.0, 1.0);
    EmitVertex();
  }
}

[geometry layout]
input type GL_TRIANGLES
output type GL_TRIANGLE_STRIP
vertices out 3

[fragment shader]
#version 110

void main()
{
  gl_FragColor = gl_Color;
}

[vertex data]
vertex/float/2 f_in/float/1
-1.0 -1.0      0
 1.0 -1.0      1
 1.0  1.0      2
-1.0  1.0      3

[test]
draw arrays GL_TRIANGLE_FAN 0 4
probe all rgba 0.0 1.0 0.0 1.0
